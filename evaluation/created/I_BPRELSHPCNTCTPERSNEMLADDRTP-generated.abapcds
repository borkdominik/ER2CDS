@AccessControl.authorizationCheck: #CHECK
@Metadata.ignorePropagatedAnnotations: true
@EndUserText.label: 'Generated by ER2CDS'
define view entity I_BPRelshpCntctPersnEmlAddrTP as select
    from I_BpContactToAddress as ContactPerson
    inner join I_AddressEmailAddress as EmailAddress on ContactPerson.AddressID = EmailAddress.AddressID and ContactPerson.PersonNumber = EmailAddress.Person
    association[0..1] to I_BusPartRelationshipTP as _BusPartRelationship on $projection.BusinessPartner1 = _BusPartRelationship.BusinessPartner1 and $projection.BusinessPartner2 = _BusPartRelationship.BusinessPartner2 and $projection.ValidityEndDate = _BusPartRelationship.ValidityEndDate and $projection.RelationshipCategory = _BusPartRelationship.RelationshipCategory
    association[0..1] to I_BPRelshpContactPersonTP as _BPRelshpContactPerson on $projection.BusinessPartner1 = _BPRelshpContactPerson.BusinessPartner1 and $projection.BusinessPartner2 = _BPRelshpContactPerson.BusinessPartner2 and $projection.ValidityEndDate = _BPRelshpContactPerson.ValidityEndDate and $projection.RelationshipCategory = _BPRelshpContactPerson.RelationshipCategory
    association to parent I_BPRelshpCntctPersnAddressTP as _BPRelshpCntctPersnAddress on $projection.BusinessPartner1 = _BPRelshpCntctPersnAddress.BusinessPartner1 and $projection.BusinessPartner2 = _BPRelshpCntctPersnAddress.BusinessPartner2 and $projection.ValidityEndDate = _BPRelshpCntctPersnAddress.ValidityEndDate and $projection.RelationshipCategory = _BPRelshpCntctPersnAddress.RelationshipCategory and $projection.AddressID = _BPRelshpCntctPersnAddress.AddressID

{
    key ContactPerson.BusinessPartnerCompany as BusinessPartner1,
    key ContactPerson.BusinessPartnerPerson as BusinessPartner2,
    key ContactPerson.ValidityEndDate,
    key ContactPerson.AddressID,
    key EmailAddress.OrdinalNumber,
    key _BusPartRelationship.RelationshipCategory,
    ContactPerson.RelationshipNumber,
    EmailAddress.EmailAddress,
    EmailAddress.IsDefaultEmailAddress,
    EmailAddress.CommNumberIsNotUsed,
    EmailAddress.IsHomeEmailAddress,
    _BusPartRelationship,
    _BPRelshpContactPerson,
    _BPRelshpCntctPersnAddress
}